<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>IDOL GENESIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Zen+Kaku+Gothic+New:wght@400;700;900&family=Dela+Gothic+One&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #FF1493;
            --secondary: #00D4FF;
            --gold: #FFD700;
            --dark: #0f0f1a;
            --card: rgba(25, 25, 45, 0.95);
            --success: #00ff88;
            --danger: #ff4466;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Zen Kaku Gothic New', sans-serif;
            background: var(--dark);
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* ===== TITLE SCREEN ===== */
        .title-screen {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 2rem 1rem;
            background: 
                radial-gradient(ellipse at 30% 20%, rgba(255,20,147,0.3) 0%, transparent 50%),
                radial-gradient(ellipse at 70% 80%, rgba(0,212,255,0.3) 0%, transparent 50%),
                var(--dark);
            position: relative;
            z-index: 1;
        }

        /* ËÉåÊôØ„Å´„ÅÜ„Å£„Åô„Çâ„Ç¢„Ç§„Éâ„É´„ÅÆÁîªÂÉè„ÇíÂÖ•„Çå„ÇãË£ÖÈ£æ */
        .title-bg-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('https://images.unsplash.com/photo-1605406518013-eb61958c8a14?q=80&w=1000&auto=format&fit=crop');
            background-size: cover;
            background-position: center;
            opacity: 0.2;
            z-index: -1;
            filter: grayscale(50%);
        }

        .title-logo {
            font-family: 'Dela Gothic One', cursive;
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary), var(--gold));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
            text-align: center;
            filter: drop-shadow(0 0 15px rgba(255,20,147,0.3));
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { filter: drop-shadow(0 0 10px rgba(255,20,147,0.5)); }
            to { filter: drop-shadow(0 0 20px rgba(0,212,255,0.5)); }
        }

        .title-sub {
            font-size: 0.8rem;
            color: #fff;
            letter-spacing: 0.3em;
            margin-bottom: 2rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.8);
        }

        .name-input {
            background: rgba(0,0,0,0.5);
            border: 2px solid var(--primary);
            border-radius: 30px;
            padding: 1rem 1.5rem;
            font-size: 1.1rem;
            color: #fff;
            text-align: center;
            width: 80%;
            max-width: 280px;
            margin-bottom: 1.5rem;
            outline: none;
            backdrop-filter: blur(5px);
        }

        .name-input::placeholder { color: #ccc; }

        .start-btn {
            background: linear-gradient(135deg, var(--primary), #ff69b4);
            border: none;
            padding: 1rem 3rem;
            font-size: 1.1rem;
            font-weight: 700;
            color: #fff;
            border-radius: 30px;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(255,20,147,0.4);
            transition: transform 0.2s;
        }
        .start-btn:active { transform: scale(0.95); }

        /* ===== GAME SCREEN ===== */
        .game-screen {
            display: none;
            min-height: 100vh;
            padding-bottom: 80px;
            background: 
                radial-gradient(ellipse at 50% 0%, rgba(255,20,147,0.15) 0%, transparent 50%),
                var(--dark);
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.8rem 1rem;
            background: var(--card);
            border-bottom: 1px solid rgba(255,255,255,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .idol-name {
            font-family: 'Dela Gothic One', cursive;
            font-size: 1rem;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .day-badge {
            background: linear-gradient(135deg, var(--gold), #ffa500);
            color: #000;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
        }

        /* Idol Visual Section */
        .idol-visual-section {
            padding: 1.5rem 1rem 1rem;
            text-align: center;
        }

        .idol-avatar-container {
            position: relative;
            width: 140px; /* Â∞ë„ÅóÂ§ß„Åç„Åè„Åó„Åæ„Åó„Åü */
            height: 140px;
            margin: 0 auto 1rem;
        }

        /* „Éï„Ç©„Éà„É™„Ç¢„É´Áî®„Å´CSS„ÇíÂ§âÊõ¥ */
        .idol-avatar {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover; /* ÁîªÂÉè„ÅÆÊØîÁéá„ÇíÁ∂≠ÊåÅ„Åó„Å¶„Éà„É™„Éü„É≥„Ç∞ */
            border: 4px solid var(--primary);
            box-shadow: 0 0 30px rgba(255,20,147,0.5);
            background: #333; /* Ë™≠„ÅøËæº„ÅøÂâç„ÅÆËâ≤ */
            transition: border-color 0.5s, box-shadow 0.5s;
        }

        .level-badge {
            position: absolute;
            bottom: 0;
            right: 0;
            background: linear-gradient(135deg, var(--gold), #ffa500);
            color: #000;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-size: 1.1rem;
            border: 3px solid var(--dark);
            z-index: 2;
        }

        .idol-rank {
            font-size: 0.85rem;
            color: var(--gold);
            letter-spacing: 0.1em;
            margin-bottom: 0.5rem;
            font-weight: bold;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }

        .fans-display {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .fans-icon { font-size: 1.2rem; }

        .fans-count {
            font-family: 'Dela Gothic One', cursive;
            font-size: 1.5rem;
            color: var(--gold);
        }

        .fans-change {
            font-size: 0.8rem;
            padding: 0.2rem 0.5rem;
            border-radius: 10px;
        }
        .fans-change.positive { background: rgba(0,255,136,0.2); color: var(--success); }
        .fans-change.negative { background: rgba(255,68,102,0.2); color: var(--danger); }

        /* Hexagon Radar Chart */
        .radar-section {
            padding: 0.5rem 1rem 1rem;
        }

        .radar-container {
            background: var(--card);
            border-radius: 16px;
            padding: 1rem;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .radar-title {
            font-size: 0.8rem;
            color: #888;
            text-align: center;
            margin-bottom: 0.5rem;
        }

        .radar-chart {
            width: 100%;
            max-width: 250px;
            margin: 0 auto;
        }

        /* Condition Bars */
        .condition-section {
            padding: 0 1rem;
            display: flex;
            gap: 0.8rem;
        }

        .condition-item {
            flex: 1;
            background: var(--card);
            border-radius: 12px;
            padding: 0.8rem;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .condition-header {
            display: flex;
            justify-content: space-between;
            font-size: 0.75rem;
            margin-bottom: 0.4rem;
        }

        .condition-label { color: #888; }
        .condition-value { font-weight: 700; }

        .condition-bar {
            height: 6px;
            background: rgba(255,255,255,0.1);
            border-radius: 3px;
            overflow: hidden;
        }

        .condition-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.3s;
        }
        .condition-fill.energy { background: linear-gradient(90deg, #00ff88, #00cc66); }
        .condition-fill.motivation { background: linear-gradient(90deg, var(--primary), #ff69b4); }

        /* Action Section */
        .action-section {
            padding: 1rem;
        }

        .action-tabs {
            display: flex;
            gap: 0.4rem;
            margin-bottom: 0.8rem;
            overflow-x: auto;
            padding-bottom: 0.3rem;
            scrollbar-width: none;
        }
        .action-tabs::-webkit-scrollbar { display: none; }

        .tab-btn {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            color: #888;
            font-size: 0.8rem;
            white-space: nowrap;
            cursor: pointer;
            transition: all 0.2s;
        }

        .tab-btn.active {
            background: linear-gradient(135deg, var(--primary), #ff69b4);
            color: #fff;
            border-color: transparent;
            font-weight: bold;
        }

        .action-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.6rem;
        }

        .action-card {
            background: var(--card);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 0.8rem;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
        }

        .action-card:active {
            transform: scale(0.98);
            border-color: var(--primary);
        }

        .action-card.disabled {
            opacity: 0.4;
            pointer-events: none;
        }

        .action-icon { font-size: 1.5rem; margin-bottom: 0.3rem; }
        .action-name { font-size: 0.85rem; font-weight: 700; margin-bottom: 0.2rem; }
        .action-desc { font-size: 0.65rem; color: #aaa; line-height: 1.3; margin-bottom: 0.4rem; }
        .action-cost { font-size: 0.65rem; color: var(--gold); }
        .action-req { font-size: 0.6rem; color: var(--primary); margin-top: 0.2rem; font-weight: bold; }

        /* Next Day Button */
        .next-day-btn {
            position: fixed;
            bottom: 1rem;
            left: 1rem;
            right: 1rem;
            background: linear-gradient(135deg, var(--gold), #ffa500);
            border: none;
            padding: 1rem;
            font-size: 1rem;
            font-weight: 700;
            color: #000;
            border-radius: 16px;
            cursor: pointer;
            z-index: 100;
            box-shadow: 0 5px 20px rgba(255,215,0,0.3);
            transition: all 0.3s;
        }

        .next-day-btn:disabled {
            background: #333;
            color: #666;
            box-shadow: none;
            transform: translateY(100%);
        }

        /* ===== MODALS ===== */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 1rem;
            backdrop-filter: blur(5px);
        }

        .modal-card {
            background: var(--card);
            border-radius: 20px;
            padding: 1.5rem;
            width: 100%;
            max-width: 350px;
            max-height: 90vh;
            overflow-y: auto;
            border: 2px solid var(--primary);
            animation: modalIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
        }

        @keyframes modalIn {
            from { transform: scale(0.9) translateY(20px); opacity: 0; }
            to { transform: scale(1) translateY(0); opacity: 1; }
        }

        .modal-type {
            font-size: 0.7rem;
            color: var(--secondary);
            text-transform: uppercase;
            letter-spacing: 0.2em;
            text-align: center;
        }

        .modal-title {
            font-family: 'Dela Gothic One', cursive;
            font-size: 1.3rem;
            text-align: center;
            margin: 0.5rem 0 1rem;
            background: linear-gradient(90deg, var(--primary), var(--gold));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1.4;
        }

        .modal-desc {
            font-size: 0.9rem;
            color: #ccc;
            text-align: center;
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }

        .choice-btn {
            display: block;
            width: 100%;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.2);
            padding: 1rem;
            border-radius: 12px;
            color: #fff;
            text-align: left;
            margin-bottom: 0.6rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .choice-btn:active {
            background: rgba(255,20,147,0.2);
            border-color: var(--primary);
            transform: scale(0.98);
        }

        .choice-text { font-weight: 700; font-size: 0.95rem; margin-bottom: 0.2rem; }
        .choice-hint { font-size: 0.75rem; color: #888; }

        .result-changes {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }

        .change-item {
            display: flex;
            justify-content: space-between;
            padding: 0.4rem 0;
            font-size: 0.9rem;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .change-item:last-child { border-bottom: none; }
        
        .change-item.positive { color: var(--success); }
        .change-item.negative { color: var(--danger); }

        .modal-btn {
            width: 100%;
            background: linear-gradient(135deg, var(--primary), #ff69b4);
            border: none;
            padding: 1rem;
            font-size: 1rem;
            font-weight: 700;
            color: #fff;
            border-radius: 30px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(255,20,147,0.3);
        }

        /* ===== ENDING SCREEN ===== */
        .ending-screen {
            display: none;
            min-height: 100vh;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            text-align: center;
            background: 
                radial-gradient(ellipse at 50% 30%, rgba(255,215,0,0.3) 0%, transparent 50%),
                var(--dark);
        }

        .ending-icon {
            font-size: 5rem;
            margin-bottom: 1rem;
            animation: bounce 1s ease infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        .ending-title {
            font-family: 'Dela Gothic One', cursive;
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }
        .ending-title.success {
            background: linear-gradient(135deg, var(--gold), var(--primary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .ending-title.failure { color: #666; }

        .ending-subtitle {
            font-size: 0.9rem;
            color: #888;
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        .ending-stats {
            background: var(--card);
            border-radius: 16px;
            padding: 1rem;
            margin-bottom: 2rem;
            width: 100%;
            max-width: 280px;
        }

        .ending-stat {
            display: flex;
            justify-content: space-between;
            padding: 0.6rem 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            font-size: 0.9rem;
        }
        .ending-stat:last-child { border-bottom: none; }

        .restart-btn {
            background: linear-gradient(135deg, var(--secondary), #0099cc);
            border: none;
            padding: 1rem 3rem;
            font-size: 1rem;
            font-weight: 700;
            color: #fff;
            border-radius: 30px;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(0,212,255,0.3);
        }

        /* Milestone Toast */
        .milestone-toast {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, var(--card), rgba(40,40,60,0.98));
            border: 3px solid var(--gold);
            border-radius: 20px;
            padding: 2rem;
            text-align: center;
            z-index: 2000;
            width: 90%;
            max-width: 320px;
            animation: milestoneIn 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            box-shadow: 0 0 50px rgba(255,215,0,0.5);
        }

        @keyframes milestoneIn {
            from { transform: translate(-50%, -50%) scale(0); }
            to { transform: translate(-50%, -50%) scale(1); }
        }

        .milestone-icon { font-size: 3rem; margin-bottom: 0.5rem; }
        .milestone-title { font-family: 'Dela Gothic One', cursive; color: var(--gold); margin-bottom: 0.5rem; font-size: 1.5rem; }
        .milestone-desc { font-size: 0.9rem; color: #fff; margin-bottom: 1.5rem; }
        .milestone-close {
            background: var(--gold);
            border: none;
            padding: 0.8rem 2.5rem;
            border-radius: 30px;
            font-weight: 700;
            cursor: pointer;
            color: #000;
            font-size: 1rem;
        }

        .toast-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1999;
            backdrop-filter: blur(3px);
        }
    </style>
</head>
<body>

<div class="title-screen" id="titleScreen">
    <div class="title-bg-image"></div>
    <h1 class="title-logo">IDOL GENESIS</h1>
    <p class="title-sub">„Ç¢„Ç§„Éâ„É´ËÇ≤Êàê„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥</p>
    <input type="text" class="name-input" id="idolNameInput" placeholder="„Ç¢„Ç§„Éâ„É´Âêç„ÇíÂÖ•Âäõ" maxlength="10">
    <button class="start-btn" id="startBtn">„Éá„Éì„É•„ÉºÈñãÂßã</button>
</div>

<div class="game-screen" id="gameScreen">
    <header class="header">
        <div class="idol-name" id="displayName">„ÇÜ„ÇÅ</div>
        <div class="day-badge">DAY <span id="dayCount">1</span></div>
    </header>

    <div class="idol-visual-section">
        <div class="idol-avatar-container">
            <img class="idol-avatar" id="idolAvatar" src="" alt="Idol Avatar">
            <div class="level-badge" id="levelBadge">1</div>
        </div>
        <div class="idol-rank" id="idolRank">üå± Êñ∞‰∫∫„Ç¢„Ç§„Éâ„É´</div>
        <div class="fans-display">
            <span class="fans-icon">üë•</span>
            <span class="fans-count" id="fansCount">100</span>
            <span class="fans-change" id="fansChange"></span>
        </div>
    </div>

    <div class="radar-section">
        <div class="radar-container">
            <div class="radar-title">‚≠ê ËÉΩÂäõ„Éû„Éà„É™„ÇØ„Çπ</div>
            <svg class="radar-chart" id="radarChart" viewBox="0 0 200 180"></svg>
        </div>
    </div>

    <div class="condition-section">
        <div class="condition-item">
            <div class="condition-header">
                <span class="condition-label">‚ö° ‰ΩìÂäõ</span>
                <span class="condition-value" id="energyValue">100</span>
            </div>
            <div class="condition-bar">
                <div class="condition-fill energy" id="energyBar" style="width:100%"></div>
            </div>
        </div>
        <div class="condition-item">
            <div class="condition-header">
                <span class="condition-label">üî• „ÇÑ„ÇãÊ∞ó</span>
                <span class="condition-value" id="motivationValue">100</span>
            </div>
            <div class="condition-bar">
                <div class="condition-fill motivation" id="motivationBar" style="width:100%"></div>
            </div>
        </div>
    </div>

    <div class="action-section">
        <div class="action-tabs" id="actionTabs">
            <button class="tab-btn active" data-tab="training">„É¨„ÉÉ„Çπ„É≥</button>
            <button class="tab-btn" data-tab="work">‰ªï‰∫ã</button>
            <button class="tab-btn" data-tab="rest">‰ºëÊÅØ</button>
            <button class="tab-btn" data-tab="special">„Ç§„Éô„É≥„Éà</button>
        </div>
        <div class="action-grid" id="actionGrid"></div>
    </div>

    <button class="next-day-btn" id="nextDayBtn" disabled>ÁøåÊó•„Å∏ÈÄ≤„ÇÄ ‚Üí</button>
</div>

<div class="modal-overlay" id="eventModal">
    <div class="modal-card">
        <div class="modal-type" id="eventType">„Ç§„Éô„É≥„Éà</div>
        <h2 class="modal-title" id="eventTitle">„Çø„Ç§„Éà„É´</h2>
        <p class="modal-desc" id="eventDesc">Ë™¨Êòé</p>
        <div id="eventChoices"></div>
    </div>
</div>

<div class="modal-overlay" id="resultModal">
    <div class="modal-card">
        <h2 class="modal-title" id="resultTitle">ÁµêÊûú</h2>
        <p class="modal-desc" id="resultMsg">„É°„ÉÉ„Çª„Éº„Ç∏</p>
        <div class="result-changes" id="resultChanges"></div>
        <button class="modal-btn" id="resultClose">Á∂ö„Åë„Çã</button>
    </div>
</div>

<div class="ending-screen" id="endingScreen">
    <div class="ending-icon" id="endingIcon">üëë</div>
    <h1 class="ending-title" id="endingTitle">IDOL OF IDOLS</h1>
    <p class="ending-subtitle" id="endingSubtitle">Êù±‰∫¨„Éâ„Éº„É†55,000‰∫∫„ÇíÊÑüÂãï„Åï„Åõ„ÅüÔºÅ</p>
    <div class="ending-stats">
        <div class="ending-stat"><span>ÊúÄÁµÇÊó•</span><span id="finalDay">-</span></div>
        <div class="ending-stat"><span>„Éï„Ç°„É≥Êï∞</span><span id="finalFans">-</span></div>
        <div class="ending-stat"><span>„Ç§„Éô„É≥„ÉàÊï∞</span><span id="finalEvents">-</span></div>
    </div>
    <button class="restart-btn" id="restartBtn">„ÇÇ„ÅÜ‰∏ÄÂ∫¶„Éó„É¨„Ç§</button>
</div>

<div class="toast-overlay" id="toastOverlay"></div>
<div class="milestone-toast" id="milestoneToast">
    <div class="milestone-icon" id="milestoneIcon">üéâ</div>
    <h3 class="milestone-title" id="milestoneTitle">ÈÅîÊàêÔºÅ</h3>
    <p class="milestone-desc" id="milestoneDesc">Ë™¨Êòé</p>
    <button class="milestone-close" id="milestoneClose">OK</button>
</div>

<script>
// ============================================
// IDOL GENESIS v2 - Photoreal Edition
// ============================================

const TOKYO_DOME = 55000;

const state = {
    name: '',
    day: 1,
    fans: 100,
    fansChange: 0,
    stats: { vocal: 10, dance: 10, visual: 10, charm: 10, mental: 10, luck: 10 },
    energy: 100,
    motivation: 100,
    actions: 0,
    maxActions: 2,
    events: 0,
    tab: 'training',
    milestones: {}
};

// ============================================
// „ÄêË®≠ÂÆö„Äë„Ç¢„Ç§„Éâ„É´ÁîªÂÉè„É™„Çπ„Éà
// „Åì„Åì„ÇíÂ•Ω„Åç„Å™ÁîªÂÉè„ÅÆURLÔºàhttps://... „Åæ„Åü„ÅØ ./image.jpgÔºâ„Å´Â§âÊõ¥„Åó„Å¶„Åè„Å†„Åï„ÅÑ
// ============================================
const idolImages = {
    // „É¨„Éô„É´1„Äú2: Êñ∞‰∫∫„Éª„Ç´„Ç∏„É•„Ç¢„É´ÔºàËá™ÁÑ∂„Å™Èõ∞Âõ≤Ê∞óÔºâ
    rookie: "https://images.unsplash.com/photo-1542038784456-1ea8e935640e?q=80&w=400&auto=format&fit=crop",
    
    // „É¨„Éô„É´3„Äú4: ÈÅ∏Êäú„Éª„Éï„Ç°„ÉÉ„Ç∑„Éß„É≥ÔºàÊ¥óÁ∑¥„Åï„Çå„ÅüÈõ∞Âõ≤Ê∞óÔºâ
    member: "https://images.unsplash.com/photo-1616683693504-3ea7e9ad6fec?q=80&w=400&auto=format&fit=crop",
    
    // „É¨„Éô„É´5„Äú6: „Éà„ÉÉ„Éó„Ç¢„Ç§„Éâ„É´„Éª„Çπ„ÉÜ„Éº„Ç∏ÔºàËèØ„ÇÑ„Åã„Å™Èõ∞Âõ≤Ê∞óÔºâ
    star: "https://images.unsplash.com/photo-1534528741775-53994a69daeb?q=80&w=400&auto=format&fit=crop"
};

// „É©„É≥„ÇØÂÆöÁæ©„Å®Ëâ≤Ë®≠ÂÆö
const idolStages = [
    { level: 1, rank: 'üå± Êñ∞‰∫∫„Ç¢„Ç§„Éâ„É´', color: '#ffb6c1' },
    { level: 2, rank: 'üå∏ Á†îÁ©∂Áîü', color: '#ff69b4' },
    { level: 3, rank: '‚≠ê Ê≠£Ë¶è„É°„É≥„Éê„Éº', color: '#ff1493' },
    { level: 4, rank: 'üåü ÈÅ∏Êäú„É°„É≥„Éê„Éº', color: '#ff00ff' },
    { level: 5, rank: 'üí´ „Çª„É≥„Çø„Éº', color: '#9400d3' },
    { level: 6, rank: 'üëë „Éà„ÉÉ„Éó„Ç¢„Ç§„Éâ„É´', color: '#ffd700' }
];

const actions = {
    training: [
        { id: 'vocal', name: '„Éú„Ç§„Éà„É¨', icon: 'üé§', desc: 'Ê≠åÂî±ÂäõUP', cost: 20, fx: { vocal: [3,6] } },
        { id: 'dance', name: '„ÉÄ„É≥„Çπ', icon: 'üíÉ', desc: '„ÉÄ„É≥„ÇπÂäõUP', cost: 25, fx: { dance: [3,6] } },
        { id: 'visual', name: '„Éì„Ç∏„É•„Ç¢„É´', icon: '‚ú®', desc: 'Ë°®ÁèæÂäõUP', cost: 15, fx: { visual: [3,6] } },
        { id: 'charm', name: '„Éà„Éº„ÇØ', icon: 'üí¨', desc: '„Ç´„É™„Çπ„ÉûUP', cost: 15, fx: { charm: [3,6] } },
        { id: 'mental', name: '„É°„É≥„Çø„É´', icon: 'üßò', desc: 'Á≤æÁ•ûÂäõUP', cost: 10, fx: { mental: [4,8] } },
        { id: 'all', name: 'Á∑èÂêà', icon: 'üåü', desc: 'ÂÖ®‰ΩìUP', cost: 30, fx: { vocal:[1,3], dance:[1,3], visual:[1,3], charm:[1,3] } }
    ],
    work: [
        { id: 'street', name: 'Ë∑Ø‰∏ä„É©„Ç§„Éñ', icon: 'üé∏', desc: '„Éï„Ç°„É≥Áç≤Âæó', cost: 20, req: {}, fx: { fans: [10,50] } },
        { id: 'sns', name: 'SNSÊäïÁ®ø', icon: 'üì±', desc: 'Ë™çÁü•Â∫¶UP', cost: 10, req: {}, fx: { fans: [5,30] } },
        { id: 'local', name: 'Âú∞Âüü„Ç§„Éô„É≥„Éà', icon: 'üè™', desc: 'Âú∞ÂÖÉ„Åß‰∫∫Ê∞ó', cost: 25, req: { fans: 500 }, fx: { fans: [30,100] } },
        { id: 'radio', name: '„É©„Ç∏„Ç™Âá∫Êºî', icon: 'üìª', desc: '„É°„Éá„Ç£„Ç¢Èú≤Âá∫', cost: 15, req: { fans: 1000 }, fx: { fans: [50,150] } },
        { id: 'magazine', name: 'ÈõëË™åÊíÆÂΩ±', icon: 'üì∏', desc: '‰∫∫Ê∞óÊÄ•‰∏äÊòá', cost: 20, req: { fans: 2000 }, fx: { fans: [80,200] } },
        { id: 'tv', name: '„ÉÜ„É¨„ÉìÂá∫Êºî', icon: 'üì∫', desc: 'ÂÖ®ÂõΩÂå∫„Å´', cost: 30, req: { fans: 5000 }, fx: { fans: [200,500] } }
    ],
    rest: [
        { id: 'break', name: '‰ºëÊÜ©', icon: '‚òï', desc: '‰ΩìÂäõÂõûÂæ©', cost: 0, fx: { energy: [15,25], motivation: [5,10] } },
        { id: 'sleep', name: '‰ºëÈ§äÊó•', icon: 'üõèÔ∏è', desc: 'ÂÆåÂÖ®ÂõûÂæ©', cost: 0, fx: { energy: [40,60], motivation: [10,20] } },
        { id: 'spa', name: '„Ç®„Çπ„ÉÜ', icon: 'üßñ', desc: 'ÁæéÂÆπ„Ç±„Ç¢', cost: 0, fx: { energy: [25,35], visual: [1,3] } },
        { id: 'hobby', name: 'Ë∂£Âë≥', icon: 'üéÆ', desc: '„É™„Éï„É¨„ÉÉ„Ç∑„É•', cost: 0, fx: { motivation: [20,35], luck: [1,3] } }
    ],
    special: [
        { id: 'mini', name: '„Éü„Éã„É©„Ç§„Éñ', icon: 'üéµ', desc: '100‰∫∫Ë¶èÊ®°', cost: 40, req: { fans: 500, vocal: 20, dance: 20 }, fx: { fans: [100,300] }, isEvent: true },
        { id: 'shake', name: 'Êè°Êâã‰ºö', icon: 'ü§ù', desc: '„Éï„Ç°„É≥‰∫§ÊµÅ', cost: 35, req: { fans: 1000, charm: 25 }, fx: { fans: [150,400] }, isEvent: true },
        { id: 'solo', name: '„ÇΩ„É≠„É©„Ç§„Éñ', icon: 'üé§', desc: '1000‰∫∫Ë¶èÊ®°', cost: 50, req: { fans: 3000, vocal: 35, dance: 35 }, fx: { fans: [500,1000] }, isEvent: true },
        { id: 'arena', name: '„Ç¢„É™„Éº„Éä', icon: 'üèüÔ∏è', desc: '1‰∏á‰∫∫Ë¶èÊ®°', cost: 60, req: { fans: 15000, vocal: 50, dance: 50, mental: 40 }, fx: { fans: [2000,5000] }, isEvent: true },
        { id: 'dome', name: 'Êù±‰∫¨„Éâ„Éº„É†', icon: 'üëë', desc: '5.5‰∏á‰∫∫ÔºÅ', cost: 80, req: { fans: 50000, vocal: 70, dance: 70, visual: 60, charm: 60, mental: 60 }, fx: { fans: [5000,10000] }, isEvent: true, isFinal: true }
    ]
};

const randomEvents = [
    {
        type: 'Âç±Ê©ü', title: '„Çπ„Ç≠„É£„É≥„ÉÄ„É´Â†±ÈÅì',
        desc: 'ÈÄ±ÂàäË™å„Å´„ÅÇ„Å™„Åü„ÅÆÂôÇ„Åå...„Å©„ÅÜÂØæÂøú„Åô„ÇãÔºü',
        choices: [
            { text: 'ÂÖ¨Âºè„Å´Âê¶ÂÆö', hint: '„É°„É≥„Çø„É´ÂãùË≤†', check: 'mental', ok: { fans: [-100,100], mental: [3,5] }, ng: { fans: [-500,-200] } },
            { text: 'Ê≤àÈªô„ÇíÂÆà„Çã', hint: 'ÈÅã‰ªª„Åõ', check: 'luck', ok: { fans: [-50,50] }, ng: { fans: [-300,-100] } },
            { text: '„É¶„Éº„É¢„Ç¢„ÅßËøî„Åô', hint: '„Ç´„É™„Çπ„ÉûÂãùË≤†', check: 'charm', ok: { fans: [100,300] }, ng: { fans: [-400,-200] } }
        ]
    },
    {
        type: '„ÉÅ„É£„É≥„Çπ', title: '„Éó„É≠„Éá„É•„Éº„Çµ„Éº„Åã„Çâ„Ç™„Éï„Ç°„Éº',
        desc: 'Â§ßÁâ©P„Åã„ÇâÊñ∞Êõ≤Âà∂‰Ωú„ÅÆË©±„ÅåÔºÅ',
        choices: [
            { text: 'Âèó„Åë„Çã', hint: 'ËÉΩÂäõÂ§ßÂπÖUP', ok: { vocal: [5,10], dance: [5,10], energy: [-40,-30], fans: [200,500] } },
            { text: 'Êñ≠„Çã', hint: '‰ªä„ÅÆË∑ØÁ∑öÁ∂ôÁ∂ö', ok: { motivation: [10,20], mental: [2,4] } }
        ]
    },
    {
        type: '„ÉÅ„É£„É≥„Çπ', title: 'SNS„Åß„Éê„Ç∫„Å£„ÅüÔºÅ',
        desc: '„ÅÇ„Å™„Åü„ÅÆÂãïÁîª„ÅåÂ§ßÊã°Êï£ÔºÅ',
        choices: [
            { text: 'ÈÖç‰ø°Â¢ó„ÇÑ„Åô', hint: '„Éì„Ç∏„É•„Ç¢„É´ÂãùË≤†', check: 'visual', ok: { fans: [300,800] }, ng: { fans: [100,200] } },
            { text: 'ÊÑüË¨ù„Çí‰ºù„Åà„Çã', hint: '„Ç´„É™„Çπ„ÉûUP', ok: { fans: [200,400], charm: [3,5] } }
        ]
    },
    {
        type: '„É©„Ç§„Éê„É´', title: '„É©„Ç§„Éê„É´ÁôªÂ†¥ÔºÅ',
        desc: 'Êñ∞‰∫∫„Ç¢„Ç§„Éâ„É´„ÅåË©±È°å„Å´...',
        choices: [
            { text: '„É¨„ÉÉ„Çπ„É≥Âº∑Âåñ', hint: 'Ë≤†„Åë„Å™„ÅÑÔºÅ', ok: { vocal: [3,5], dance: [3,5], energy: [-25,-15] } },
            { text: '„Ç≥„É©„ÉúÊèêÊ°à', hint: 'ÈÅãÊ¨°Á¨¨„ÅßÂ§ßÊàêÂäü', check: 'luck', ok: { fans: [300,600] }, ng: { fans: [-100,50] } },
            { text: '„Éû„Ç§„Éö„Éº„Çπ', hint: '„É°„É≥„Çø„É´Âº∑Âåñ', ok: { mental: [4,8] } }
        ]
    },
    {
        type: '„Åª„Å£„Åì„Çä', title: '„Éï„Ç°„É≥„Åã„Çâ„ÅÆÊâãÁ¥ô',
        desc: 'ÂøÉ„ÅÆ„Åì„ÇÇ„Å£„Åü„Éó„É¨„Çº„É≥„Éà„ÅåÂ±ä„ÅÑ„Åü',
        choices: [
            { text: 'SNS„Åß„ÅäÁ§º', hint: '„Éï„Ç°„É≥Â¢óÂä†', ok: { fans: [50,150], motivation: [15,25] } },
            { text: 'Áõ¥Á≠Ü„ÅÆËøî‰∫ã', hint: 'Ë™†ÊÑè„Åå‰ºù„Çè„Çã', ok: { motivation: [20,35], mental: [2,4] } }
        ]
    }
];

// DOM
const $ = id => document.getElementById(id);

function init() {
    $('startBtn').onclick = startGame;
    $('nextDayBtn').onclick = nextDay;
    $('resultClose').onclick = () => $('resultModal').style.display = 'none';
    $('restartBtn').onclick = restart;
    $('milestoneClose').onclick = closeMilestone;
    
    document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.onclick = () => switchTab(btn.dataset.tab);
    });
    
    $('idolNameInput').onkeypress = e => { if (e.key === 'Enter') startGame(); };
}

function startGame() {
    state.name = $('idolNameInput').value.trim() || '„ÇÜ„ÇÅ';
    $('displayName').textContent = state.name;
    $('titleScreen').style.display = 'none';
    $('gameScreen').style.display = 'block';
    
    // „Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥Áî®
    $('gameScreen').style.opacity = 0;
    setTimeout(() => {
        $('gameScreen').style.transition = 'opacity 1s';
        $('gameScreen').style.opacity = 1;
    }, 100);

    updateAll();
}

function switchTab(tab) {
    state.tab = tab;
    document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.tab === tab);
    });
    renderActions();
}

function renderActions() {
    const list = actions[state.tab];
    $('actionGrid').innerHTML = list.map(a => {
        const canDo = checkReq(a) && state.energy >= a.cost && state.actions < state.maxActions;
        return `
            <div class="action-card ${canDo ? '' : 'disabled'}" onclick="${canDo ? `doAction('${state.tab}','${a.id}')` : ''}">
                <div class="action-icon">${a.icon}</div>
                <div class="action-name">${a.name}</div>
                <div class="action-desc">${a.desc}</div>
                <div class="action-cost">‚ö°-${a.cost}</div>
                ${a.req ? `<div class="action-req">${formatReq(a.req)}</div>` : ''}
            </div>
        `;
    }).join('');
}

function checkReq(a) {
    if (!a.req) return true;
    for (const [k, v] of Object.entries(a.req)) {
        if (k === 'fans' && state.fans < v) return false;
        if (state.stats[k] !== undefined && state.stats[k] < v) return false;
    }
    return true;
}

function formatReq(req) {
    const parts = [];
    if (req.fans) parts.push(`„Éï„Ç°„É≥${req.fans.toLocaleString()}`);
    for (const s of ['vocal','dance','visual','charm','mental']) {
        if (req[s]) parts.push(`${s.charAt(0).toUpperCase()}${req[s]}`);
    }
    return parts.join(' ');
}

function doAction(tab, id) {
    const a = actions[tab].find(x => x.id === id);
    if (!a || state.actions >= state.maxActions) return;
    
    state.energy -= a.cost;
    state.actions++;
    
    const changes = applyEffects(a.fx);
    
    if (a.isFinal && state.fans >= TOKYO_DOME) {
        state.events++;
        setTimeout(() => showEnding(true), 500);
        return;
    }
    
    if (a.isEvent) state.events++;
    
    showResult(a.name, 'ÊàêÂäüÔºÅ', changes);
    updateAll();
    
    if (state.actions >= state.maxActions) {
        $('nextDayBtn').disabled = false;
        $('nextDayBtn').style.transform = 'translateY(0)';
    }
    
    checkMilestones();
}

function applyEffects(fx, mult = 1) {
    const changes = {};
    for (const [k, range] of Object.entries(fx)) {
        const v = Math.round(rand(range[0], range[1]) * mult);
        if (k === 'fans') {
            state.fans = Math.max(0, state.fans + v);
            changes.fans = v;
        } else if (k === 'energy') {
            state.energy = clamp(state.energy + v, 0, 100);
            changes.energy = v;
        } else if (k === 'motivation') {
            state.motivation = clamp(state.motivation + v, 0, 100);
            changes.motivation = v;
        } else if (state.stats[k] !== undefined) {
            state.stats[k] = Math.min(100, state.stats[k] + v);
            changes[k] = v;
        }
    }
    return changes;
}

function showResult(title, msg, changes) {
    $('resultTitle').textContent = title;
    $('resultMsg').textContent = msg;
    
    const names = { fans: '„Éï„Ç°„É≥', vocal: '„Éú„Éº„Ç´„É´', dance: '„ÉÄ„É≥„Çπ', visual: '„Éì„Ç∏„É•„Ç¢„É´', charm: '„Ç´„É™„Çπ„Éû', mental: '„É°„É≥„Çø„É´', luck: 'ÈÅã', energy: '‰ΩìÂäõ', motivation: '„ÇÑ„ÇãÊ∞ó' };
    
    $('resultChanges').innerHTML = Object.entries(changes)
        .filter(([k, v]) => v !== 0)
        .map(([k, v]) => `<div class="change-item ${v > 0 ? 'positive' : 'negative'}">
            <span>${names[k]}</span><span>${v > 0 ? '+' : ''}${k === 'fans' ? v.toLocaleString() : v}</span>
        </div>`).join('');
    
    $('resultModal').style.display = 'flex';
}

function nextDay() {
    state.day++;
    state.actions = 0;
    $('nextDayBtn').disabled = true;
    
    // Recovery
    state.energy = clamp(state.energy + rand(15, 25), 0, 100);
    state.motivation = clamp(state.motivation + rand(-5, 10), 0, 100);
    
    // Fan flux
    const avg = Object.values(state.stats).reduce((a, b) => a + b, 0) / 6;
    const flux = Math.round((avg - 30) * (state.fans / 1000) * (Math.random() * 0.5 + 0.5));
    state.fansChange = flux;
    state.fans = Math.max(0, state.fans + flux);
    
    if (state.fans <= 0) { showEnding(false); return; }
    if (state.day > 365) { showEnding(false, 'timeout'); return; }
    
    // Random event 10%
    if (Math.random() < 0.1) {
        triggerEvent();
    }
    
    updateAll();
    checkMilestones();
}

function triggerEvent() {
    const e = randomEvents[Math.floor(Math.random() * randomEvents.length)];
    
    $('eventType').textContent = e.type;
    $('eventTitle').textContent = e.title;
    $('eventDesc').textContent = e.desc;
    
    $('eventChoices').innerHTML = e.choices.map((c, i) => `
        <button class="choice-btn" onclick="resolveEvent(${JSON.stringify(e).replace(/"/g, '&quot;')}, ${i})">
            <div class="choice-text">${c.text}</div>
            <div class="choice-hint">${c.hint}</div>
        </button>
    `).join('');
    
    $('eventModal').style.display = 'flex';
}

window.resolveEvent = function(e, i) {
    $('eventModal').style.display = 'none';
    
    const c = e.choices[i];
    let ok = true;
    
    if (c.check) {
        const stat = state.stats[c.check] || 50;
        ok = stat >= 30 + Math.random() * 40;
    }
    
    const fx = ok ? c.ok : (c.ng || c.ok);
    const changes = applyEffects(fx);
    
    showResult(e.title, ok ? '‰∏äÊâã„Åè„ÅÑ„Å£„ÅüÔºÅ' : 'Â§±Êïó...', changes);
    updateAll();
    
    if (state.fans <= 0) setTimeout(() => showEnding(false), 1000);
};

function checkMilestones() {
    const checks = [
        { key: 'f1k', fans: 1000, icon: 'üåü', title: '1,000‰∫∫Á™ÅÁ†¥ÔºÅ', desc: 'È†ÜË™ø„Å™„Çπ„Çø„Éº„ÉàÔºÅ' },
        { key: 'f5k', fans: 5000, icon: '‚≠ê', title: '5,000‰∫∫Á™ÅÁ†¥ÔºÅ', desc: 'Ê≥®ÁõÆÂ∫¶UPÔºÅ' },
        { key: 'f10k', fans: 10000, icon: 'üî•', title: '1‰∏á‰∫∫Á™ÅÁ†¥ÔºÅ', desc: '„Éñ„É¨„Ç§„ÇØÔºÅ' },
        { key: 'f50k', fans: 50000, icon: 'üëë', title: '5‰∏á‰∫∫Á™ÅÁ†¥ÔºÅ', desc: '„Éâ„Éº„É†„ÅåË¶ã„Åà„ÅüÔºÅ' }
    ];
    
    for (const c of checks) {
        if (!state.milestones[c.key] && state.fans >= c.fans) {
            state.milestones[c.key] = true;
            showMilestone(c.icon, c.title, c.desc);
            break;
        }
    }
}

function showMilestone(icon, title, desc) {
    $('milestoneIcon').textContent = icon;
    $('milestoneTitle').textContent = title;
    $('milestoneDesc').textContent = desc;
    $('toastOverlay').style.display = 'block';
    $('milestoneToast').style.display = 'block';
}

function closeMilestone() {
    $('toastOverlay').style.display = 'none';
    $('milestoneToast').style.display = 'none';
}

function showEnding(win, reason = '') {
    $('gameScreen').style.display = 'none';
    $('endingScreen').style.display = 'flex';
    
    if (win) {
        $('endingIcon').textContent = 'üëë';
        $('endingTitle').textContent = 'IDOL OF IDOLS';
        $('endingTitle').className = 'ending-title success';
        $('endingSubtitle').textContent = `${state.name}„ÅØÊù±‰∫¨„Éâ„Éº„É†55,000‰∫∫„ÇíÊÑüÂãï„Åï„Åõ„ÅüÔºÅ`;
    } else {
        $('endingIcon').textContent = reason === 'timeout' ? '‚è∞' : 'üíî';
        $('endingTitle').textContent = reason === 'timeout' ? 'TIME OVER' : 'GAME OVER';
        $('endingTitle').className = 'ending-title failure';
        $('endingSubtitle').textContent = reason === 'timeout' ? '365Êó•„ÅåÈÅé„Åé„Åü...' : '„Éï„Ç°„É≥„Åå„ÅÑ„Å™„Åè„Å™„Å£„Åü...';
    }
    
    $('finalDay').textContent = state.day;
    $('finalFans').textContent = state.fans.toLocaleString();
    $('finalEvents').textContent = state.events;
}

function restart() {
    Object.assign(state, {
        day: 1, fans: 100, fansChange: 0,
        stats: { vocal: 10, dance: 10, visual: 10, charm: 10, mental: 10, luck: 10 },
        energy: 100, motivation: 100, actions: 0, events: 0, tab: 'training', milestones: {}
    });
    $('endingScreen').style.display = 'none';
    $('titleScreen').style.display = 'flex';
    $('idolNameInput').value = '';
}

function updateAll() {
    $('dayCount').textContent = state.day;
    $('fansCount').textContent = state.fans.toLocaleString();
    
    if (state.fansChange !== 0) {
        $('fansChange').textContent = `${state.fansChange > 0 ? '+' : ''}${state.fansChange.toLocaleString()}`;
        $('fansChange').className = `fans-change ${state.fansChange > 0 ? 'positive' : 'negative'}`;
    } else {
        $('fansChange').textContent = '';
        $('fansChange').className = 'fans-change';
    }
    
    $('energyValue').textContent = state.energy;
    $('energyBar').style.width = state.energy + '%';
    $('motivationValue').textContent = state.motivation;
    $('motivationBar').style.width = state.motivation + '%';
    
    updateIdolVisual();
    updateRadar();
    renderActions();
}

function updateIdolVisual() {
    // „Çπ„ÉÜ„Éº„Çø„ÇπÂêàË®à„Åß„É¨„Éô„É´Ë®àÁÆó
    const total = Object.values(state.stats).reduce((a, b) => a + b, 0);
    let level = 1;
    if (total >= 400) level = 6;
    else if (total >= 300) level = 5;
    else if (total >= 200) level = 4;
    else if (total >= 120) level = 3;
    else if (total >= 80) level = 2;
    
    const stage = idolStages[level - 1];
    $('levelBadge').textContent = level;
    $('idolRank').textContent = stage.rank;
    
    // ÁîªÂÉèURL„ÅÆÂàá„ÇäÊõø„ÅàÔºàSVGÁîüÊàê„ÇíÂªÉÊ≠¢„Åó„ÄÅsrc„ÇíÂ§âÊõ¥Ôºâ
    const imgEl = $('idolAvatar');
    let targetSrc = idolImages.rookie;
    
    if (level >= 5) {
        targetSrc = idolImages.star;
        imgEl.style.borderColor = "#FFD700"; // ÈáëÊû†
        imgEl.style.boxShadow = "0 0 50px rgba(255,215,0,0.8)";
    } else if (level >= 3) {
        targetSrc = idolImages.member;
        imgEl.style.borderColor = "#FF1493"; // „Éî„É≥„ÇØÊû†
        imgEl.style.boxShadow = "0 0 30px rgba(255,20,147,0.5)";
    } else {
        targetSrc = idolImages.rookie;
        imgEl.style.borderColor = "#fff"; // ÁôΩÊû†
        imgEl.style.boxShadow = "none";
    }
    
    // ÁîªÂÉè„ÅåÊó¢„Å´Âêå„Åò„Å™„ÇâÂÜçË™≠„ÅøËæº„Åø„Åó„Å™„ÅÑ
    if (!imgEl.src.includes(targetSrc)) {
        imgEl.src = targetSrc;
    }
}

function updateRadar() {
    const svg = $('radarChart');
    const cx = 100, cy = 85, r = 65;
    const stats = ['vocal', 'dance', 'visual', 'charm', 'mental', 'luck'];
    const labels = ['„Éú„Éº„Ç´„É´', '„ÉÄ„É≥„Çπ', '„Éì„Ç∏„É•„Ç¢„É´', '„Ç´„É™„Çπ„Éû', '„É°„É≥„Çø„É´', 'ÈÅã'];
    const colors = ['#ff6b9d', '#00d4ff', '#ffd700', '#ff69b4', '#9966ff', '#00ff88'];
    
    // Calculate points
    const getPoint = (i, val) => {
        const angle = (Math.PI * 2 * i / 6) - Math.PI / 2;
        const dist = (val / 100) * r;
        return { x: cx + Math.cos(angle) * dist, y: cy + Math.sin(angle) * dist };
    };
    
    // Background hexagons
    let bgHex = '';
    for (let level = 20; level <= 100; level += 20) {
        const pts = [];
        for (let i = 0; i < 6; i++) {
            const p = getPoint(i, level);
            pts.push(`${p.x},${p.y}`);
        }
        bgHex += `<polygon points="${pts.join(' ')}" fill="none" stroke="rgba(255,255,255,${level === 100 ? 0.2 : 0.1})" stroke-width="1"/>`;
    }
    
    // Axis lines
    let axes = '';
    for (let i = 0; i < 6; i++) {
        const p = getPoint(i, 100);
        axes += `<line x1="${cx}" y1="${cy}" x2="${p.x}" y2="${p.y}" stroke="rgba(255,255,255,0.1)" stroke-width="1"/>`;
    }
    
    // Data polygon
    const dataPoints = stats.map((s, i) => getPoint(i, state.stats[s]));
    const dataPoly = dataPoints.map(p => `${p.x},${p.y}`).join(' ');
    
    // Labels and values
    let labelsHtml = '';
    stats.forEach((s, i) => {
        const angle = (Math.PI * 2 * i / 6) - Math.PI / 2;
        const lx = cx + Math.cos(angle) * (r + 22);
        const ly = cy + Math.sin(angle) * (r + 22);
        labelsHtml += `
            <text x="${lx}" y="${ly}" fill="${colors[i]}" font-size="9" text-anchor="middle" dominant-baseline="middle">${labels[i]}</text>
            <text x="${lx}" y="${ly + 11}" fill="#fff" font-size="10" font-weight="bold" text-anchor="middle">${state.stats[s]}</text>
        `;
    });
    
    svg.innerHTML = `
        ${bgHex}
        ${axes}
        <polygon points="${dataPoly}" fill="rgba(255,20,147,0.3)" stroke="var(--primary)" stroke-width="2"/>
        ${dataPoints.map((p, i) => `<circle cx="${p.x}" cy="${p.y}" r="4" fill="${colors[i]}"/>`).join('')}
        ${labelsHtml}
    `;
}

// Utilities
function rand(min, max) { return Math.floor(Math.random() * (max - min + 1)) + min; }
function clamp(v, min, max) { return Math.min(max, Math.max(min, v)); }

// Start
init();
</script>

</body>
</html>
